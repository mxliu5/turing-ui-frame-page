import{$ as o,u as M,a as Z,g as K}from"./index-10a79b7e.js";import{g as z,a2 as Q,k as g,y as E,H as O,F as B,r as p,o as L,j as X,l as u,N as s,a1 as r,u as T,G as J,a3 as ee,a4 as te,p as oe,v as q,t as W}from"./vendor-31e96ae5.js";import{u as ae}from"./useTablePage-7b6d25a8.js";function P(i){return o("tip.formatError")+"："+o("tip.onlySupport")+i}const U=o("tip.nameValidateTip"),le=o("tip.codeValidateTip"),ne=P(U),se=P(le),re=/^[a-zA-Z0-9_\s\-\u4e00-\u9fa5]+$/;function ie(i){return i?re.test(i):!0}const de=/^[a-zA-Z0-9_-\s]+$/;function ue(i){return i?de.test(i):!0}const ce=()=>({validateNameRule:(h,c,a,d)=>{if(c==="")return a(new Error(d));if(ie(c))a();else return a(new Error(ne))},validateCodeRule:(h,c,a,d)=>{if(c==="")return a(new Error(d));if(ue(c))a();else return a(new Error(se))}}),pe={class:"drag-wrapper"},me=z({__name:"add",emits:["reload"],setup(i,{expose:m,emit:h}){const{proxy:c}=M(),{t:a}=Q(),{api:d}=Z(),R=g("YYYY-MM-DD"),w=E(()=>b.value==="add"?a("btn.new"):a("btn.edit")),x=E(()=>b.value==="edit"),y=g(!1),$=()=>{v.value.resetForm(),y.value=!1},A=()=>{v.value.submitForm(l=>{l&&(x.value,console.log("params",t.value))})},{validateNameRule:I}=ce(),b=g("add"),v=g(null),e={id:void 0,name:"",appId:"",city:[],date:"",age:"",enable:!1,school:"北京大学",hobby:[],desc:"",file1:null,file2:null};let t=g(O({},e));const f=B({name:[{required:!0,trigger:"blur",validator:(l,n,D)=>I(l,n,D,"请输入模版名称")}],appId:[{required:!0,message:"请选择类型",trigger:"change"}],file1:[{required:!0,message:"请上传文件",trigger:"change"}],file2:[{required:!0,message:"请上传文件",trigger:"change"}]}),_=g({name:{label:"名称",labelTooltip:{content:"这是一段关于名称的提示信息"},type:"el-input",attrs:{maxlength:30,placeholder:U}},appId:{label:"应用",type:"el-select",options:[],attrs:{clearable:!1},events:{change:l=>{console.log(l)}}},city:{label:"城市",type:"el-cascader",options:[],attrs:{props:{checkStrictly:!0,value:"code",label:"name",children:"children"}}},date:{label:"日期",type:"el-date-picker",attrs:{type:"date",placeholder:"请选择日期",format:R,"value-format":R}},age:{label:"年龄",type:"el-input-number",width:"200px",attrs:{min:1,max:100,step:1}},enable:{label:"是否启用",type:"el-switch"},school:{label:"学校",type:"el-radio-group",childCompName:"el-radio",options:[{value:"北京大学",label:"北京大学"},{value:"清华大学",label:"清华大学"},{value:"复旦大学",label:"复旦大学"}]},hobby:{label:"爱好",type:"el-checkbox-group",childCompName:"el-checkbox",options:[{value:"唱歌",label:"唱歌"},{value:"跳舞",label:"跳舞"},{value:"羽毛球",label:"羽毛球"},{value:"游泳",label:"游泳"},{value:"跑步",label:"跑步"}]},desc:{label:"描述",type:"el-input",attrs:{type:"textarea",maxlength:50,showWordLimit:!0,autosize:{minRows:2,maxRows:3}}},file1:{label:"内置文件上传",type:"upload",attrs:{accept:".zip",maxSize:"50M"},hidden:()=>x.value},file2:{label:"自定义上传",type:"slot",slotName:"file",hidden:()=>x.value}}),N=async l=>{const n=await d.getAppOptions(l);_.value.appId.options=n.list,_.value.appId.attrs.remote=n.total>d.MAX_TOTAL},k=async()=>{const l=await d.getCityOptions();_.value.city.options=l},S=()=>{N(),k()},C=async(l,n)=>{b.value=l,y.value=!0,S(),J(()=>{l==="edit"?t.value=ee(n,te(e)):(t.value=O({},e),c.$refs.uploadRef.clearFiles())})},j=()=>{console.log("下载模版")};return m({openDialog:C}),(l,n)=>{const D=p("tu-svg-icon"),Y=p("tu-upload"),G=p("tu-form"),H=p("my-drawer");return L(),X(H,{class:"mock-add",modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=V=>y.value=V),title:w.value,onConfirm:A,onClose:$},{default:u(()=>[s(G,{ref_key:"formRef",ref:v,labelWidth:"128px",labelPosition:"right",rules:f,ruleForm:r(t),formItems:_.value},{file:u(()=>[s(Y,{customRequest:"",ref:"uploadRef",maxSize:"10M",accept:".xls,.xlsx",modelValue:r(t).file2,"onUpdate:modelValue":n[0]||(n[0]=V=>r(t).file2=V),drag:"","drag-style":"",downloadTemplate:j},{default:u(()=>[T("div",pe,[s(D,{name:"upload",width:"60px"}),n[2]||(n[2]=T("div",{class:"drag-tip"},"点击或者将文件拖拽到这里进行上传",-1))])]),_:1},8,["modelValue"])]),_:1},8,["rules","ruleForm","formItems"])]),_:1},8,["modelValue","title"])}}}),fe={class:"mock-list"},be={style:{display:"inline-block",color:"red","margin-left":"5px"}},F="mock-demo",ve=z({__name:"list",setup(i){const{$app:m,proxy:h,$router:c}=M(),{query:a,queryItems:d,searchQuery:R,selectedIds:w,handleSelectionChange:x}=ae(F);a.value={city:[],keywords:""},d.value={city:{label:"城市",type:"el-cascader",options:[{code:"anhui",name:"安徽",children:[{code:"hefei",name:"合肥"},{code:"fuyang",name:"阜阳"},{code:"tongning",name:"铜陵"}]},{code:"jiangsu",name:"江苏",children:[{code:"nanjing",name:"南京"},{code:"suzhou",name:"苏州"},{code:"wuxi",name:"无锡"}]}],attrs:{props:{checkStrictly:!0,value:"code",label:"name",children:"children"}}},keywords:{type:"el-input",label:o("common.keywordSearch"),showAppend:!0,attrs:{placeholder:o("placeholder.searchByKey")}}};const y=g([{prop:"name",label:o("common.name"),minWidth:180,showOverflowTooltip:!1,custom:"editInput",customRender:{blur:e=>{console.log("当前行",e),v()}}},{prop:"appId",label:"APPID",withCopy:!0,width:280,showOverflowTooltip:!1},{prop:"type",label:o("common.type"),minWidth:150,custom:"tag-status",customRender:{options:{1:{type:"danger",name:"黑名单"},2:{type:"primary",name:"白名单"}},tagAttrs:{size:"small",round:!0}}},{prop:"status",label:o("common.status"),minWidth:150,custom:"status",customRender:{options:{1:{type:"success",name:"已发布"},2:{type:"info",name:"未发布"},3:{type:"danger",name:"已驳回"},4:{type:"warning",name:"上线审核中"},5:{type:"primary",name:"下线审核中"}},tips:e=>e.rejectReason}},{prop:"enable",label:o("common.enableOrNot"),minWidth:150,custom:"switch",customRender:{disabled:e=>e.status===1,beforeChange:e=>new Promise((t,f)=>{e.enable===1?m.$confirm({title:"确定禁用？"}).then(()=>{t(!0)}).catch(()=>{f()}):t(!0)})}},{prop:"num",label:"关联数量",minWidth:100,custom:"link",customRender:{disabled:e=>e.num===0,click:e=>{console.log(e)},attrs:{font:{fontWeight:600}}}},{prop:"desc",label:"自定义插槽11",custom:"slot",minWidth:280},{prop:"date",label:o("common.updateTime"),minWidth:180},{prop:"operation",label:o("common.operation"),width:180,fixed:"right"}]),$=[{type:"detail",label:o("btn.detail")},{type:"edit",label:o("btn.edit")},{type:"delete",label:o("btn.delete"),btnType:"danger",disabled:e=>e.status===3,disabledTips:"已发布状态不支持删除！",collapsed:!0},{type:"publish",label:o("btn.publish"),exist:e=>[2,3].includes(e.status),collapsed:!0},{type:"offline",label:o("btn.offline"),exist:e=>e.status===1,collapsed:!0}],A=e=>e.map(t=>t),I=e=>{const{type:t,record:f}=e;b[t](f)},b=B({add:()=>{var e;(e=h.$refs.addRef)==null||e.openDialog("add")},batchDelete:()=>{m.$deleteConfirm({title:"确认删除选中的模版"}).then(()=>{console.log("删除的项",w.value)})},detail:e=>{c.push({name:`${F}::detail`,params:{id:e.id}})},edit:e=>{var t;(t=h.$refs.addRef)==null||t.openDialog("edit",e)},delete:e=>{m.$deleteConfirm({title:o("tip.deleteConfirmTitle",{t:"模版名称",n:e.name})}).then(()=>{console.log("删除",e),m.$message.warning("接口待提供！")})},publish:e=>{m.$confirm({title:"确定发布当前模版？"}).then(()=>{console.log("发布",e)}).catch(()=>{})}}),v=()=>{h.$refs.myTableRef.loadData()};return(e,t)=>{const f=p("tu-button"),_=p("Service"),N=p("el-icon"),k=p("tu-tooltip"),S=p("TablePage");return L(),oe("div",fe,[s(S,{ref:"myTableRef",query:r(a),queryItems:r(d),queryAttrs:{labelColon:!1,refreshBtn:{show:!0}},operationAttrs:{selectedTotal:r(w).length},columns:y.value,operations:$,"with-order":!1,"with-selection":"","selection-option":{selectable:C=>C.status!==1,"reserve-selection":!0},tableAttrs:{"row-key":"id"},loadDataApi:r(K),transformListData:A,onHandleOperation:I,onSelectionChange:r(x),onSearch:r(R)},{buttonGroup:u(()=>[s(f,{type:"add",onClick:b.add},{default:u(()=>t[0]||(t[0]=[q("新建模版")])),_:1},8,["onClick"]),s(f,{type:"delete",tooltipButton:{clickable:r(w).length>0,handle:"删除"},onClick:b.batchDelete},{default:u(()=>t[1]||(t[1]=[q(" 批量删除 ")])),_:1},8,["tooltipButton","onClick"])]),desc:u(C=>[s(N,null,{default:u(()=>[s(_)]),_:1}),T("span",be,W(C.row.desc),1)]),"status-header":u(()=>[q(W(r(o)("common.status")),1),s(k,{content:"状态的相关提示信息"})]),"desc-header":u(()=>[t[2]||(t[2]=T("b",{style:{color:"blue"}},"自定义头部",-1)),s(k,{content:"当前列的头部内容自定义名称以prop-header命名"})]),_:1},8,["query","queryItems","operationAttrs","columns","selection-option","loadDataApi","onSelectionChange","onSearch"]),s(me,{ref:"addRef",onReload:v},null,512)])}}});export{ve as default};
